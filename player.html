<!doctype html>
<html lang="ca">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>La casa del terror</title>

<style>
  :root{
    --neon:#00ff00;
    --ink:#eaeaea;
    --muted:#cfcfcf;
  }

  *{ box-sizing:border-box; }

  html, body{ -webkit-tap-highlight-color: transparent; }

  button, a, .crt{
    -webkit-tap-highlight-color: transparent;
    -webkit-appearance: none;
    appearance: none;
    outline: none;
    touch-action: manipulation;
  }

  :focus{ outline:none; }
  button:focus-visible, a:focus-visible{ outline:none; }

  body{
    margin:0;
    font-family: Arial, sans-serif;
    color:var(--ink);
    min-height:100vh;
    display:flex;
    justify-content:center;
    padding:32px 14px;
    overflow-x:hidden;

    background:
      repeating-radial-gradient(
        circle at 30% 40%,
        rgba(255,255,255,.04) 0,
        rgba(255,255,255,.04) 1px,
        transparent 2px,
        transparent 7px
      ),
      repeating-radial-gradient(
        circle at 70% 60%,
        rgba(255,255,255,.025) 0,
        rgba(255,255,255,.025) 1px,
        transparent 1px,
        transparent 4px
      ),
      linear-gradient(
        180deg,
        rgba(255,255,255,.06),
        rgba(0,0,0,.08)
      ),
      linear-gradient(
        180deg,
        #1a1412,
        #0e0a09 50%,
        #050303
      );
  }

  .wrap{
    width:100%;
    max-width:820px;
    text-align:center;
  }

  .back{
    display:inline-block;
    color:var(--ink);
    text-decoration:none;
    opacity:.75;
    margin-bottom:14px;
    border-bottom:1px dotted rgba(255,255,255,.35);
    padding-bottom:2px;
  }
  .back:hover{ opacity:1; color:var(--neon); border-bottom-color:rgba(0,255,0,.65); }

  h1{
    margin: 0 0 6px 0;
    font-size: 22px;
    letter-spacing: .22em;
    font-weight: 800;
    text-transform: uppercase;
    color: var(--ink);
    opacity: .95;
  }

  #now-playing{
    margin: 0 0 12px 0;
    color:var(--muted);
    opacity:.9;
    font-size:13px;
    letter-spacing:.08em;
  }
  #track-name{ color:var(--ink); }

  /* TV CRT */
  .crt{
    position:relative;
    width:fit-content;
    margin:12px auto 18px;
    isolation:isolate;
    cursor:pointer;
    border-radius:12px;
  }

  #cover{
    width:100%;
    max-width:420px;
    border-radius:12px;
    display:block;
    filter:drop-shadow(0 0 22px rgba(0,0,0,.85));
    animation: crt-flicker 4.5s infinite;
    transition: transform .2s ease;
    user-select:none;
    -webkit-user-drag:none;
  }

  .crt::before{
    content:"";
    position:absolute;
    inset:0;
    background:
      repeating-linear-gradient(
        to bottom,
        rgba(255,255,255,.025),
        rgba(255,255,255,.025) 1px,
        transparent 1px,
        transparent 3px
      );
    pointer-events:none;
    mix-blend-mode:overlay;
    opacity:.25;
    z-index:2;
    border-radius:12px;
  }

  .crt:active #cover{ transform: translateY(-1px); }
  .crt:hover #cover{ transform: translateY(-2px); animation: crt-glitch .35s steps(2,end); }

  /* Controls */
  .controls{
    display:flex;
    justify-content:center;
    align-items:center;
    gap:12px;
    margin: 10px 0 10px;
    flex-wrap:wrap;
  }

  /* Bot√≥n circular base */
  button{
    border:none;
    width:52px;
    height:52px;
    padding:0;
    border-radius:999px;
    display:inline-flex;
    align-items:center;
    justify-content:center;
    background: rgba(0,255,0,.12);
    color: var(--ink);
    cursor:pointer;
    border:1px solid rgba(0,255,0,.25);
    transition:.18s ease;
    line-height:1;
  }

  button:hover{
    transform: translateY(-1px);
    border-color: rgba(0,255,0,.45);
    color: var(--neon);
  }

  /* Play: c√≠rculo + ‚Äún√∫cleo‚Äù ne√≥n */
  #play-pause{
    background: var(--neon);
    color:#000;
    border-color: rgba(0,255,0,0);
    box-shadow:0 0 22px rgba(0,255,0,.28);
  }
  #play-pause:hover{
    color:#000;
    box-shadow:0 0 34px rgba(0,255,0,.45);
  }

  /* Botones acciones: m√°s peque√±os */
  .actions{
    display:flex;
    justify-content:center;
    gap:12px;
    flex-wrap:wrap;
    margin: 6px 0 6px;
  }
  .icon-btn{
    width:44px;
    height:44px;
    background: rgba(0,0,0,.25);
    color: var(--muted);
    border:1px solid rgba(255,255,255,.14);
    box-shadow:none;
  }
  .icon-btn:hover{
    color: var(--neon);
    border-color: rgba(0,255,0,.35);
  }
  .icon-btn.on{
    background: rgba(0,255,0,.14);
    color: var(--neon);
    border-color: rgba(0,255,0,.45);
    box-shadow:0 0 18px rgba(0,255,0,.18);
  }

  /* SVG icons use currentColor */
  .ico{
    width:22px;
    height:22px;
    fill:none;
    stroke:currentColor;
    stroke-width:2;
    stroke-linecap:round;
    stroke-linejoin:round;
  }
  #play-pause .ico{ width:24px; height:24px; stroke:#000; }

  #status-line{
    min-height:18px;
    font-size:12px;
    color:var(--muted);
    opacity:.9;
    margin: 8px 0 10px;
    letter-spacing:.06em;
  }

  /* Progress */
  .progress-wrapper{
    display:flex;
    align-items:center;
    justify-content:space-between;
    width:min(680px, 100%);
    margin: 0 auto;
    gap:10px;
  }
  .progress-container{
    flex:1;
    height:8px;
    background: rgba(255,255,255,0.10);
    border-radius:999px;
    cursor:pointer;
    overflow:hidden;
    border:1px solid rgba(255,255,255,.10);
  }
  .progress-bar{
    width:0%;
    height:100%;
    border-radius:999px;
    background: linear-gradient(90deg, rgba(0,255,0,.35), rgba(0,255,0,.8), rgba(0,255,0,.35));
    background-size:400% 100%;
    animation: flow 4s linear infinite;
    transition: width 0.1s linear;
  }
  @keyframes flow{ 0%{background-position:0%} 100%{background-position:400%} }

  #current-time,#total-time{
    font-size:12px;
    color:var(--muted);
    min-width:46px;
    text-align:center;
  }

  /* Volume */
  .volume-wrapper{
    margin-top:16px;
    display:flex;
    align-items:center;
    justify-content:center;
    gap:10px;
  }
  .volume-icon{
    width:44px;
    height:44px;
    display:inline-flex;
    align-items:center;
    justify-content:center;
    border-radius:999px;
    background: rgba(0,0,0,.25);
    color: var(--muted);
    border:1px solid rgba(255,255,255,.14);
    cursor:pointer;
    transition:.18s ease;
  }
  .volume-icon:hover{
    color: var(--neon);
    border-color: rgba(0,255,0,.35);
    transform: translateY(-1px);
  }
  #volume-slider{
    width:160px;
    height:4px;
    cursor:pointer;
    accent-color: var(--neon);
  }

  /* Playlist */
  .playlist{
    margin:22px auto 0;
    text-align:left;
    width:min(720px, 100%);
  }
  .track{
    padding:10px 14px;
    border-radius:10px;
    background: rgba(255,255,255,0.05);
    margin:8px 0;
    transition: background 0.2s, transform 0.15s, border-color .2s;
    cursor:pointer;
    border:1px solid rgba(255,255,255,.08);
    color: var(--ink);
  }
  .track:hover{
    background: rgba(255,255,255,0.09);
    transform: translateY(-1px);
    border-color: rgba(0,255,0,.25);
  }
  .track.current{
    background: rgba(0,255,0,0.10);
    border-color: rgba(0,255,0,.45);
    color: var(--neon);
  }

  .sig{
    margin-top:16px;
    font-size:12px;
    opacity:.6;
    letter-spacing:.14em;
    text-transform:uppercase;
    color:var(--muted);
  }

  @keyframes crt-flicker{
    0%{filter:brightness(1) contrast(1)}
    50%{filter:brightness(.97) contrast(1)}
    100%{filter:brightness(1) contrast(1)}
  }
  @keyframes crt-glitch{
    0%{transform:translate(0); filter:none}
    25%{transform:translate(-1px,0); filter:hue-rotate(-6deg)}
    50%{transform:translate(1px,0); filter:hue-rotate(6deg)}
    75%{transform:translate(-1px,0); filter:contrast(1.1)}
    100%{transform:translate(0); filter:none}
  }

  @media (max-width:480px){
    body{ padding:22px 14px; }
    h1{ font-size:18px; }
    .progress-wrapper{ gap:8px; }
    #volume-slider{ width: 140px; }
  }

  @media (prefers-reduced-motion: reduce){
    #cover{ animation:none !important; }
    .crt:hover #cover{ animation:none !important; }
    .progress-bar{ animation:none !important; }
  }
</style>
</head>

<body>
  <main class="wrap">
    <a href="index.html" class="back">‚Üê Salir del canal</a>

    <h1>La casa del terror</h1>
    <div id="now-playing">SONANDO: <span id="track-name">‚Äî</span></div>

    <div class="crt" onclick="togglePlay()" role="button" aria-label="Play/Pause" tabindex="0">
      <img id="cover" src="tv.png" alt="Televisi√≥n / portada" />
    </div>

    <div class="controls">
      <button id="prev-btn" onclick="prevTrack()" aria-label="Anterior" title="Anterior"></button>
      <button id="play-pause" onclick="togglePlay()" aria-label="Play/Pause" title="Play/Pause"></button>
      <button id="stop-btn" onclick="stopTrack()" aria-label="Stop" title="Stop"></button>
      <button id="next-btn" onclick="nextTrack()" aria-label="Seg√ºent" title="Seg√ºent"></button>
    </div>

    <div class="actions" aria-label="Acciones">
      <button id="shuffle-btn" class="icon-btn" onclick="toggleShuffle()" aria-label="Shuffle" title="Shuffle"></button>
      <button id="loop-btn" class="icon-btn" onclick="cycleLoop()" aria-label="Loop" title="Loop"></button>
      <button id="share-btn" class="icon-btn" onclick="sharePage()" aria-label="Compartir" title="Compartir"></button>
    </div>

    <div id="status-line"></div>

    <div class="progress-wrapper">
      <span id="current-time">0:00</span>
      <div class="progress-container" onclick="seek(event)">
        <div class="progress-bar" id="progress-bar"></div>
      </div>
      <span id="total-time">0:00</span>
    </div>

    <div class="volume-wrapper">
      <span class="volume-icon" id="volume-icon" title="Mute" role="button" tabindex="0"></span>
      <input type="range" id="volume-slider" min="0" max="100" value="100">
    </div>

    <div class="playlist">
      <div class="track" data-index="0">Los pobres m√©s</div>
      <div class="track" data-index="1">Volveremos a empezar</div>
      <div class="track" data-index="2">Qui√©n llena los shows</div>
      <div class="track" data-index="3">STOP!</div>
      <div class="track" data-index="4">Can√ß√≥ 5</div>
      <div class="track" data-index="5">Can√ß√≥ 6</div>
      <div class="track" data-index="6">Can√ß√≥ 7</div>
      <div class="track" data-index="7">Can√ß√≥ 8</div>
      <div class="track" data-index="8">Can√ß√≥ 9</div>
      <div class="track" data-index="9">La casa del terror</div>
      <div class="track" data-index="10">Tenemos que hablar</div>
    </div>

    <audio id="audio" preload="metadata"></audio>

    <div class="sig">EMISI√ìN NO AUTORIZADA ¬∑ NO AJUSTAR EL DIAL</div>
  </main>

<script>
/* --- SVG icon helper (monocromo, no emojis) --- */
const ICONS = {
  prev: `<svg class="ico" viewBox="0 0 24 24" aria-hidden="true"><path d="M6 6v12"/><path d="M18 6l-8 6 8 6z"/></svg>`,
  next: `<svg class="ico" viewBox="0 0 24 24" aria-hidden="true"><path d="M18 6v12"/><path d="M6 6l8 6-8 6z"/></svg>`,
  stop: `<svg class="ico" viewBox="0 0 24 24" aria-hidden="true"><rect x="7" y="7" width="10" height="10" rx="1"/></svg>`,
  play: `<svg class="ico" viewBox="0 0 24 24" aria-hidden="true"><path d="M9 7l10 5-10 5z"/></svg>`,
  pause: `<svg class="ico" viewBox="0 0 24 24" aria-hidden="true"><path d="M8 6v12"/><path d="M16 6v12"/></svg>`,
  shuffle: `<svg class="ico" viewBox="0 0 24 24" aria-hidden="true"><path d="M16 3h5v5"/><path d="M4 20l7-7"/><path d="M4 4l7 7"/><path d="M21 16v5h-5"/><path d="M14 14l7 7"/><path d="M14 10l7-7"/></svg>`,
  loop: `<svg class="ico" viewBox="0 0 24 24" aria-hidden="true"><path d="M17 2l4 4-4 4"/><path d="M3 11V9a4 4 0 0 1 4-4h14"/><path d="M7 22l-4-4 4-4"/><path d="M21 13v2a4 4 0 0 1-4 4H3"/></svg>`,
  loop1: `<svg class="ico" viewBox="0 0 24 24" aria-hidden="true"><path d="M17 2l4 4-4 4"/><path d="M3 11V9a4 4 0 0 1 4-4h14"/><path d="M7 22l-4-4 4-4"/><path d="M21 13v2a4 4 0 0 1-4 4H3"/><path d="M12 8v8"/><path d="M11 9h2"/></svg>`,
  share: `<svg class="ico" viewBox="0 0 24 24" aria-hidden="true"><path d="M12 16V4"/><path d="M8 8l4-4 4 4"/><path d="M6 12v7a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1v-7"/></svg>`,
  vol3: `<svg class="ico" viewBox="0 0 24 24" aria-hidden="true"><path d="M11 5L6 9H3v6h3l5 4z"/><path d="M16 8a4 4 0 0 1 0 8"/><path d="M18.5 5.5a7 7 0 0 1 0 13"/></svg>`,
  vol2: `<svg class="ico" viewBox="0 0 24 24" aria-hidden="true"><path d="M11 5L6 9H3v6h3l5 4z"/><path d="M16 8a4 4 0 0 1 0 8"/></svg>`,
  mute: `<svg class="ico" viewBox="0 0 24 24" aria-hidden="true"><path d="M11 5L6 9H3v6h3l5 4z"/><path d="M16 9l5 6"/><path d="M21 9l-5 6"/></svg>`
};

/* --- Player logic --- */
const tracks = Array.from(document.querySelectorAll(".track"));
const audio = document.getElementById("audio");
const progressBar = document.getElementById("progress-bar");

const currentTimeEl = document.getElementById("current-time");
const totalTimeEl = document.getElementById("total-time");

const volumeSlider = document.getElementById("volume-slider");
const volumeIcon = document.getElementById("volume-icon");

const trackNameEl = document.getElementById("track-name");
const statusLineEl = document.getElementById("status-line");
const shuffleBtn = document.getElementById("shuffle-btn");
const loopBtn = document.getElementById("loop-btn");
const playPauseBtn = document.getElementById("play-pause");

let currentIndex = 0;
let lastVolume = 1;
let loopMode = 0; // 0=OFF,1=SONG,2=ALBUM
let shuffleOn = false;

const sources = [
  "lospobres.mp3","vae.mp3","shows.mp3","canco4.mp3","canco5.mp3",
  "canco6.mp3","canco7.mp3","canco8.mp3","canco9.mp3","canco10.mp3","canco11.mp3"
];

const titles = [
  "Los pobres m√©s",
  "Volveremos a empezar",
  "Qui√©n llena los shows",
  "STOP!",
  "Reza",
  "De pie",
  "Quemarlo todo",
  "Nadie sabe nada",
  "Lo que no quiero",
  "La casa del terror",
  "Tenemos que hablar"
];

function formatTime(t){
  const m = Math.floor(t / 60);
  const s = Math.floor(t % 60);
  return m + ":" + ("0" + s).slice(-2);
}

function setStatus(msg){
  statusLineEl.textContent = msg || "";
  if(msg){
    clearTimeout(setStatus._t);
    setStatus._t = setTimeout(()=>{ statusLineEl.textContent = ""; }, 1400);
  }
}

function renderIcons(){
  document.getElementById("prev-btn").innerHTML = ICONS.prev;
  document.getElementById("next-btn").innerHTML = ICONS.next;
  document.getElementById("stop-btn").innerHTML = ICONS.stop;
  playPauseBtn.innerHTML = ICONS.play;
  shuffleBtn.innerHTML = ICONS.shuffle;
  loopBtn.innerHTML = ICONS.loop;
  document.getElementById("share-btn").innerHTML = ICONS.share;
  volumeIcon.innerHTML = ICONS.vol3;
}

function syncButtons(){
  shuffleBtn.classList.toggle("on", shuffleOn);
  loopBtn.classList.toggle("on", loopMode !== 0);

  if(loopMode === 0){
    loopBtn.innerHTML = ICONS.loop;
    loopBtn.title = "Loop OFF";
  } else if(loopMode === 1){
    loopBtn.innerHTML = ICONS.loop1;
    loopBtn.title = "Loop CAN√á√ì";
  } else {
    loopBtn.innerHTML = ICONS.loop;
    loopBtn.title = "Loop √ÄLBUM";
  }
}

function loadTrack(index){
  audio.src = sources[index];
  tracks.forEach(t=>t.classList.remove("current"));
  tracks[index].classList.add("current");
  trackNameEl.textContent = titles[index] || tracks[index]?.textContent || "‚Äî";
}

function setPlayIcon(){
  playPauseBtn.innerHTML = audio.paused ? ICONS.play : ICONS.pause;
}

function playTrack(index){
  currentIndex = index;
  loadTrack(index);
  audio.play().then(setPlayIcon).catch(()=>{});
}

function togglePlay(){
  if(!audio.src) loadTrack(currentIndex);
  if(audio.paused){
    audio.play().then(setPlayIcon).catch(()=>{});
  } else {
    audio.pause();
    setPlayIcon();
  }
}

function stopTrack(){
  audio.pause();
  audio.currentTime = 0;
  setPlayIcon();
}

function getRandomNextIndex(){
  if(tracks.length <= 1) return currentIndex;
  let n = currentIndex;
  while(n === currentIndex) n = Math.floor(Math.random() * tracks.length);
  return n;
}

function nextTrack(){
  if(shuffleOn) return playTrack(getRandomNextIndex());
  playTrack((currentIndex + 1) % tracks.length);
}

function prevTrack(){
  if(shuffleOn) return playTrack(getRandomNextIndex());
  playTrack((currentIndex - 1 + tracks.length) % tracks.length);
}

tracks.forEach(track=>{
  track.addEventListener("click", ()=> playTrack(parseInt(track.dataset.index, 10)));
});

audio.addEventListener("timeupdate", ()=>{
  if(!audio.duration) return;
  currentTimeEl.textContent = formatTime(audio.currentTime);
  totalTimeEl.textContent = formatTime(audio.duration);
  progressBar.style.width = (audio.currentTime/audio.duration*100) + "%";
});

function seek(event){
  if(!audio.duration) return;
  const rect = event.currentTarget.getBoundingClientRect();
  const pct = (event.clientX - rect.left) / rect.width;
  audio.currentTime = pct * audio.duration;
}

audio.addEventListener("ended", ()=>{
  if(loopMode === 1) return playTrack(currentIndex);
  if(loopMode === 2) return nextTrack();
  if(shuffleOn) return nextTrack();
  if(currentIndex === tracks.length - 1){
    stopTrack();
    setStatus("Final del disc.");
  } else {
    nextTrack();
  }
});

volumeSlider.addEventListener("input", ()=>{
  audio.volume = volumeSlider.value / 100;
  lastVolume = audio.volume;
  updateVolumeIcon();
});

function updateVolumeIcon(){
  if(audio.volume === 0) volumeIcon.innerHTML = ICONS.mute;
  else if(audio.volume < 0.5) volumeIcon.innerHTML = ICONS.vol2;
  else volumeIcon.innerHTML = ICONS.vol3;
}

volumeIcon.addEventListener("click", ()=>{
  if(audio.volume > 0){
    lastVolume = audio.volume;
    audio.volume = 0;
    volumeSlider.value = 0;
  } else {
    audio.volume = lastVolume || 1;
    volumeSlider.value = audio.volume * 100;
  }
  updateVolumeIcon();
});

function toggleShuffle(){
  shuffleOn = !shuffleOn;
  syncButtons();
  setStatus(shuffleOn ? "Shuffle ON" : "Shuffle OFF");
}

function cycleLoop(){
  loopMode = (loopMode + 1) % 3;
  syncButtons();
  setStatus(loopMode === 0 ? "Loop OFF" : (loopMode === 1 ? "Loop CAN√á√ì" : "Loop √ÄLBUM"));
}

async function sharePage(){
  const url = window.location.href;
  try{
    if(navigator.share){
      await navigator.share({ title: "Cosmic Marciana", url });
      setStatus("Compartit üíö");
    } else if(navigator.clipboard){
      await navigator.clipboard.writeText(url);
      setStatus("Link copiat üíö");
    } else {
      setStatus("No es pot copiar aqu√≠");
    }
  } catch {}
}

document.addEventListener("keydown", (e)=>{
  if(e.code === "Space"){
    e.preventDefault();
    togglePlay();
  }
  if(e.code === "ArrowRight") nextTrack();
  if(e.code === "ArrowLeft") prevTrack();
});

/* INIT: siempre empieza en 0 */
(function init(){
  renderIcons();
  currentIndex = 0;
  loadTrack(0);
  audio.volume = 1;
  updateVolumeIcon();
  syncButtons();
  setPlayIcon();
})();

/* Enter/Espacio en la TV */
const crtBtn = document.querySelector(".crt");
crtBtn?.addEventListener("keydown", (e)=>{
  if(e.key === "Enter" || e.key === " "){
    e.preventDefault();
    togglePlay();
  }
});
</script>

</body>
</html>
