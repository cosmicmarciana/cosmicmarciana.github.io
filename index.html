<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Cosmic Marciana</title>
  <link rel="icon" href="favicon.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <link rel="apple-touch-icon" href="apple-touch-icon.png">
  <link rel="manifest" href="site.webmanifest">

  <style>
    :root{
      --neon:#00ff00;
      --ink:#eaeaea;
      --muted:#cfcfcf;
    }

    *{ box-sizing:border-box; }

    body{
      margin:0;
      font-family:Arial, sans-serif;
      color:var(--ink);
      min-height:100vh;
      display:flex;
      justify-content:center;
      padding:32px 14px;
      overflow-x:hidden;

      background:
        repeating-radial-gradient(
          circle at 30% 40%,
          rgba(255,255,255,.04) 0,
          rgba(255,255,255,.04) 1px,
          transparent 2px,
          transparent 7px
        ),
        repeating-radial-gradient(
          circle at 70% 60%,
          rgba(255,255,255,.025) 0,
          rgba(255,255,255,.025) 1px,
          transparent 1px,
          transparent 4px
        ),
        linear-gradient(
          180deg,
          rgba(255,255,255,.06),
          rgba(0,0,0,.08)
        ),
        linear-gradient(
          180deg,
          #1a1412,
          #0e0a09 50%,
          #050303
        );
    }

    .wrap{
      width:100%;
      max-width:760px;
      text-align:center;
      position: relative;
    }

    /* ===== CRT ===== */
    .crt{
      position:relative;
      width:fit-content;
      margin:0 auto 22px;
      isolation:isolate;
      user-select:none;
      -webkit-tap-highlight-color: transparent;
      touch-action: manipulation;
    }

    .hero{
      width:100%;
      max-width:420px;
      display:block;
      filter:drop-shadow(0 0 22px rgba(0,0,0,.85));
      animation: crt-flicker 4.5s infinite;
      will-change: transform, filter;
      -webkit-user-drag:none;
    }

    .crt::before{
      content:"";
      position:absolute;
      inset:0;
      background:
        repeating-linear-gradient(
          to bottom,
          rgba(255,255,255,.025),
          rgba(255,255,255,.025) 1px,
          transparent 1px,
          transparent 3px
        );
      pointer-events:none;
      mix-blend-mode:overlay;
      opacity:.25;
    }

    .crt:hover .hero{
      animation: crt-glitch .35s steps(2,end);
    }

    /* ===== TEXTO ===== */
    .text{
      font-size:15px;
      line-height:1.55;
      margin:0 auto 18px;
      max-width:50ch;
      color:var(--muted);
    }

    /* ===== WHISPER ===== */
    .whisper{
      position:relative;
      display:inline-block;
      font-size:12px;
      opacity:.72;
      letter-spacing:.20em;
      text-transform:lowercase;
      margin:-6px auto 22px;
      color:var(--muted);
      user-select:none;
      animation: whisper-jitter 1.35s infinite steps(2,end);
    }

    .whisper::before,
    .whisper::after{
      content: attr(data-text);
      position:absolute;
      inset:0;
    }

    .whisper::before{
      color: rgba(0,255,0,.75);
      transform: translate(1px,0);
      animation: whisper-glitch-1 1.15s infinite linear;
    }

    .whisper::after{
      color: rgba(255,0,0,.65);
      transform: translate(-1px,0);
      animation: whisper-glitch-2 1s infinite linear;
    }

    /* ===== CTA ===== */
    .cta{ margin-bottom:18px; }

    .btn{
      display:inline-block;
      padding:16px 28px;
      font-size:16px;
      border-radius:999px;
      text-decoration:none;
      background:var(--neon);
      color:#000;
      box-shadow:0 0 22px rgba(0,255,0,.3);
      transition:.2s ease;
      white-space:normal;
      line-height:1.25;
    }

    .btn:hover{
      transform:translateY(-1px);
      box-shadow:0 0 34px rgba(0,255,0,.45);
    }

    /* ===== ICONOS ===== */
    .links.icons{
      display:flex;
      justify-content:center;
      gap:22px;
      margin-top:6px;
    }

    .links.icons a{
      padding:6px;
      opacity:.75;
      transition:.2s ease;
    }

    .links.icons a:hover{
      opacity:1;
      transform:translateY(-1px);
    }

    .links.icons svg{
      width:22px;
      height:22px;
      fill:none;
      stroke:var(--ink);
      stroke-width:1.6;
    }

    .links.icons a:hover svg{
      stroke:var(--neon);
    }

    /* ===== FIRMA CON GLITCH SUAVE ===== */
    .sig{
      position:relative;
      margin-top:16px;
      font-size:12px;
      opacity:.65;
      letter-spacing:.14em;
      text-transform:uppercase;
      color:var(--muted);
    }

    .sig::before,
    .sig::after{
      content: attr(data-text);
      position:absolute;
      inset:0;
      opacity:.5;
      pointer-events:none;
    }

    .sig::before{
      color: rgba(0,255,0,.35);
      animation: sig-glitch-1 6s infinite;
    }

    .sig::after{
      color: rgba(255,0,0,.25);
      animation: sig-glitch-2 7s infinite;
    }

    .sig .hit{
      color:var(--ink);
      opacity:.9;
    }

    /* ===== OVERLAY activar sonido (solo si el navegador bloquea) ===== */
    .sound-gate{
      position: fixed;
      inset: 0;
      display: none;
      align-items: center;
      justify-content: center;
      padding: 18px;
      background: rgba(0,0,0,.55);
      z-index: 999;
    }
    .sound-gate.show{ display:flex; }

    .sound-card{
      width: min(520px, 100%);
      border-radius: 16px;
      background: rgba(10,8,8,.96);
      border: 1px solid rgba(255,255,255,.12);
      box-shadow: 0 0 34px rgba(0,0,0,.55);
      padding: 14px 14px 12px;
      text-align:center;
    }
    .sound-title{
      font-size:12px;
      letter-spacing:.16em;
      text-transform:uppercase;
      color: var(--ink);
      opacity:.92;
      margin: 2px 0 10px;
    }
    .sound-note{
      font-size:13px;
      color: var(--muted);
      line-height:1.45;
      margin: 0 0 12px;
    }
    .sound-btn{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap:10px;
      padding: 12px 16px;
      border-radius: 999px;
      border:1px solid rgba(0,255,0,.40);
      background: rgba(0,255,0,.10);
      color: var(--ink);
      cursor:pointer;
      transition:.18s ease;
      box-shadow: 0 0 14px rgba(0,255,0,.16);
    }
    .sound-btn:hover{
      border-color: rgba(0,255,0,.70);
      color: var(--neon);
      box-shadow: 0 0 28px rgba(0,255,0,.30);
    }

    /* ===== ANIMACIONES ===== */
    @keyframes crt-flicker{
      0%{filter:brightness(1)}
      50%{filter:brightness(.97)}
      100%{filter:brightness(1)}
    }

    @keyframes crt-glitch{
      0%{transform:none}
      50%{transform:translateX(1px)}
      100%{transform:none}
    }

    @keyframes whisper-jitter{
      0%{transform:none}
      50%{transform:translate(.5px,-.5px)}
      100%{transform:none}
    }

    @keyframes whisper-glitch-1{
      12%{clip-path:inset(20% 0 60% 0)}
      14%{clip-path:inset(0)}
    }

    @keyframes whisper-glitch-2{
      18%{clip-path:inset(60% 0 10% 0)}
      20%{clip-path:inset(0)}
    }

    @keyframes sig-glitch-1{
      0%,92%{transform:none; clip-path:inset(0)}
      93%{transform:translateX(1px); clip-path:inset(40% 0 30% 0)}
      94%{transform:none; clip-path:inset(0)}
      100%{transform:none}
    }

    @keyframes sig-glitch-2{
      0%,88%{transform:none; clip-path:inset(0)}
      89%{transform:translateX(-1px); clip-path:inset(60% 0 15% 0)}
      90%{transform:none; clip-path:inset(0)}
      100%{transform:none}
    }

    @media (max-width:480px){
      .btn{
        width:100%;
        max-width:26ch;
        padding:16px 18px;
        font-size:15px;
      }
    }

    @media (prefers-reduced-motion: reduce){
      *{ animation:none !important; }
    }
  </style>
</head>

<body>
  <main class="wrap">

    <div class="crt" aria-label="Televisor CRT">
      <img src="tv.png" alt="Televisor CRT con Cosmic Marciana â€“ La casa del terror" class="hero" />
    </div>

    <p class="text">
      SeÃ±ales rotas. Pop electrÃ³nico.<br />
      Transmisiones desde otra dimensiÃ³n.
    </p>

    <div class="whisper" data-text="transmisiÃ³n en cursoâ€¦">transmisiÃ³n en cursoâ€¦</div>

    <div class="cta">
      <a class="btn" href="player.html">Â¿Te atreves a entrar en la casa del terror?</a>
    </div>

    <div class="links icons">
      <a href="https://www.instagram.com/cosmicmarciana" target="_blank" rel="noopener noreferrer" aria-label="Instagram">
        <svg viewBox="0 0 24 24"><rect x="2" y="2" width="20" height="20" rx="5"/><circle cx="12" cy="12" r="4"/><circle cx="17.5" cy="6.5" r="1.2"/></svg>
      </a>
      <a href="https://open.spotify.com/intl-es/artist/0qSO1brlu9jrjrhmMldEVL" target="_blank" rel="noopener noreferrer" aria-label="Spotify">
        <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><path d="M7 10.5c3-1 7-.8 10 .6"/><path d="M7.5 13c2.5-.7 6-.5 8.5 .5"/><path d="M8 15.5c2-.5 4.5-.4 6.5 .4"/></svg>
      </a>
      <a href="mailto:cosmicmarciana@gmail.com" aria-label="Contacto">
        <svg viewBox="0 0 24 24"><rect x="3" y="5" width="18" height="14" rx="2"/><path d="M3 7l9 6 9-6"/></svg>
      </a>
    </div>

    <div class="sig" data-text="COSMIC MARCIANA 2026 Â· EMISIÃ“N NO AUTORIZADA Â· NO AJUSTAR EL DIAL">
      COSMIC MARCIANA <span class="hit">2026</span> Â· EMISIÃ“N NO AUTORIZADA Â· NO AJUSTAR EL DIAL
    </div>

  </main>

  <!-- Overlay: solo aparece si el navegador BLOQUEA el audio -->
  <div class="sound-gate" id="sound-gate" aria-hidden="true">
    <div class="sound-card">
      <div class="sound-title">SEÃ‘AL DE AUDIO BLOQUEADA</div>
      <p class="sound-note">
        Algunos navegadores no dejan sonar la tele sin un toque.<br>
        Toca una vez para activar la seÃ±al.
      </p>
      <button class="sound-btn" id="sound-btn" type="button">ðŸ”Š ACTIVAR SONIDO</button>
    </div>
  </div>

  <!-- ===== VHS/TV TUNING NOISE (WebAudio) ===== -->
  <script>
  (() => {
    const tv = document.querySelector(".crt");
    const gate = document.getElementById("sound-gate");
    const gateBtn = document.getElementById("sound-btn");
    if (!tv || !gate || !gateBtn) return;

    let ctx, master, bus, lp, hp, sat, wobble, wobbleDepth;
    let pinkGain, hissGain, humGain, burstGain, popGain;
    let running = false;
    let unlocked = false;

    const clamp01 = (n) => Math.max(0, Math.min(1, n));

    // Pink-ish buffer (Paul Kellet-ish style by filtering white into pink feel)
    function makePinkBuffer(audioCtx, seconds = 3.0) {
      const rate = audioCtx.sampleRate;
      const length = Math.floor(rate * seconds);
      const buffer = audioCtx.createBuffer(1, length, rate);
      const out = buffer.getChannelData(0);

      // simple pink filter state
      let b0=0, b1=0, b2=0, b3=0, b4=0, b5=0, b6=0;
      for (let i = 0; i < length; i++) {
        const white = Math.random() * 2 - 1;
        b0 = 0.99886 * b0 + white * 0.0555179;
        b1 = 0.99332 * b1 + white * 0.0750759;
        b2 = 0.96900 * b2 + white * 0.1538520;
        b3 = 0.86650 * b3 + white * 0.3104856;
        b4 = 0.55000 * b4 + white * 0.5329522;
        b5 = -0.7616 * b5 - white * 0.0168980;
        const pink = (b0 + b1 + b2 + b3 + b4 + b5 + b6 + white * 0.5362) * 0.11;
        b6 = white * 0.115926;
        out[i] = pink;
      }
      return buffer;
    }

    function makeWhiteBuffer(audioCtx, seconds = 2.0) {
      const rate = audioCtx.sampleRate;
      const length = Math.floor(rate * seconds);
      const buffer = audioCtx.createBuffer(1, length, rate);
      const out = buffer.getChannelData(0);
      for (let i = 0; i < length; i++) out[i] = Math.random() * 2 - 1;
      return buffer;
    }

    function createGraph() {
      ctx = new (window.AudioContext || window.webkitAudioContext)();

      // master output
      master = ctx.createGain();
      master.gain.value = 0;
      master.connect(ctx.destination);

      // bus (antes de master)
      bus = ctx.createGain();
      bus.gain.value = 1;
      bus.connect(master);

      // filters: vintage TV (apagado)
      hp = ctx.createBiquadFilter();
      hp.type = "highpass";
      hp.frequency.value = 90;

      lp = ctx.createBiquadFilter();
      lp.type = "lowpass";
      lp.frequency.value = 3200;

      // soft saturation (analog feel)
      sat = ctx.createWaveShaper();
      sat.curve = makeSoftClipCurve(0.9);
      sat.oversample = "2x";

      // connect chain: hp -> lp -> sat -> bus
      hp.connect(lp);
      lp.connect(sat);
      sat.connect(bus);

      // wobble / wow/flutter (modulate lowpass)
      wobble = ctx.createOscillator();
      wobble.type = "sine";
      wobble.frequency.value = 1.6;

      wobbleDepth = ctx.createGain();
      wobbleDepth.gain.value = 900;
      wobble.connect(wobbleDepth);
      wobbleDepth.connect(lp.frequency);
      wobble.start();

      // pink noise base
      const pinkSrc = ctx.createBufferSource();
      pinkSrc.buffer = makePinkBuffer(ctx, 3.0);
      pinkSrc.loop = true;

      pinkGain = ctx.createGain();
      pinkGain.gain.value = 0.0;
      pinkSrc.connect(pinkGain);
      pinkGain.connect(hp);
      pinkSrc.start();

      // hiss layer (highpassed white)
      const hissSrc = ctx.createBufferSource();
      hissSrc.buffer = makeWhiteBuffer(ctx, 1.6);
      hissSrc.loop = true;

      const hissHP = ctx.createBiquadFilter();
      hissHP.type = "highpass";
      hissHP.frequency.value = 2200;

      hissGain = ctx.createGain();
      hissGain.gain.value = 0.0;

      hissSrc.connect(hissHP);
      hissHP.connect(hissGain);
      hissGain.connect(hp);
      hissSrc.start();

      // hum 50/100Hz
      const hum1 = ctx.createOscillator();
      hum1.type = "sine";
      hum1.frequency.value = 50;

      const hum2 = ctx.createOscillator();
      hum2.type = "sine";
      hum2.frequency.value = 100;

      humGain = ctx.createGain();
      humGain.gain.value = 0.0;

      hum1.connect(humGain);
      hum2.connect(humGain);
      humGain.connect(hp);

      hum1.start();
      hum2.start();

      // burst layer: short bandpassed static "tuning"
      const burstSrc = ctx.createBufferSource();
      burstSrc.buffer = makeWhiteBuffer(ctx, 1.2);
      burstSrc.loop = true;

      const burstBP = ctx.createBiquadFilter();
      burstBP.type = "bandpass";
      burstBP.frequency.value = 900;
      burstBP.Q.value = 0.8;

      burstGain = ctx.createGain();
      burstGain.gain.value = 0.0;

      burstSrc.connect(burstBP);
      burstBP.connect(burstGain);
      burstGain.connect(hp);
      burstSrc.start();

      // "clack" tiny tuner pops
      const popOsc = ctx.createOscillator();
      popOsc.type = "square";
      popOsc.frequency.value = 950;

      const popLP = ctx.createBiquadFilter();
      popLP.type = "lowpass";
      popLP.frequency.value = 1100;

      popGain = ctx.createGain();
      popGain.gain.value = 0.0;

      popOsc.connect(popLP);
      popLP.connect(popGain);
      popGain.connect(bus);
      popOsc.start();
    }

    function makeSoftClipCurve(amount = 1.0) {
      const n = 1024;
      const curve = new Float32Array(n);
      for (let i = 0; i < n; i++) {
        const x = (i * 2) / (n - 1) - 1;
        curve[i] = Math.tanh(x * (2.2 * amount));
      }
      return curve;
    }

    async function unlock() {
      if (unlocked) return true;
      try{
        if (!ctx) createGraph();
        if (ctx.state === "suspended") await ctx.resume();
        unlocked = true;
        hideGate();
        return true;
      }catch{
        // seguirÃ¡ bloqueado
        return false;
      }
    }

    function showGate(){
      gate.classList.add("show");
      gate.setAttribute("aria-hidden","false");
    }
    function hideGate(){
      gate.classList.remove("show");
      gate.setAttribute("aria-hidden","true");
    }

    function fadeMasterTo(target, ms = 140) {
      if (!master || !ctx) return;
      target = clamp01(target);
      const now = ctx.currentTime;
      master.gain.cancelScheduledValues(now);
      master.gain.setValueAtTime(master.gain.value, now);
      master.gain.linearRampToValueAtTime(target, now + ms / 1000);
    }

    function triggerPop(strength = 1){
      if(!ctx || !popGain) return;
      const now = ctx.currentTime;
      const a = 0.010 * strength;
      popGain.gain.cancelScheduledValues(now);
      popGain.gain.setValueAtTime(0, now);
      popGain.gain.linearRampToValueAtTime(a, now + 0.008);
      popGain.gain.linearRampToValueAtTime(0, now + 0.050);
    }

    let burstTimer = 0;
    function startBurstLoop(){
      stopBurstLoop();
      burstTimer = setInterval(()=>{
        if(!running || !ctx) return;
        // "estallidos" cortos tipo sintonizaciÃ³n (no constante)
        if(Math.random() < 0.35){
          const now = ctx.currentTime;
          const strength = 0.20 + Math.random() * 0.45;
          burstGain.gain.cancelScheduledValues(now);
          burstGain.gain.setValueAtTime(0, now);
          burstGain.gain.linearRampToValueAtTime(strength, now + 0.02);
          burstGain.gain.linearRampToValueAtTime(0, now + 0.12);
          if(Math.random() < 0.55) triggerPop(0.8 + Math.random() * 1.2);
        }
      }, 230);
    }
    function stopBurstLoop(){
      if(burstTimer){
        clearInterval(burstTimer);
        burstTimer = 0;
      }
    }

    function setIntensity(g){
      if(!ctx || !pinkGain || !hissGain || !humGain || !lp || !wobbleDepth) return;
      g = clamp01(g);

      // base TV noise (pink-ish): cuerpo real
      pinkGain.gain.setValueAtTime(0.18 + g * 0.55, ctx.currentTime);

      // hiss (mÃ¡s brillo cuando te acercas al â€œcanalâ€)
      hissGain.gain.setValueAtTime(0.02 + g * 0.18, ctx.currentTime);

      // hum CRT: â€œtuboâ€ y electricidad
      humGain.gain.setValueAtTime(0.03 + g * 0.10, ctx.currentTime);

      // filtro: sigue vintage; se abre un poco cuando sube la intensidad
      lp.frequency.setValueAtTime(2400 + g * 2200, ctx.currentTime);

      // tracking/wow: mÃ¡s movimiento cuando g sube
      wobbleDepth.gain.setValueAtTime(600 + g * 1900, ctx.currentTime);
    }

    async function startNoise(){
      running = true;

      // intentar desbloquear (si estÃ¡ bloqueado, mostramos gate)
      const ok = await unlock();
      if(!ok){
        showGate();
        running = false;
        return;
      }

      // â€œmordiscoâ€ inicial
      setIntensity(0.95);
      triggerPop(1.2);
      fadeMasterTo(0.24, 120);
      startBurstLoop();
    }

    function stopNoise(){
      running = false;
      stopBurstLoop();
      fadeMasterTo(0, 170);
    }

    // Desktop: hover
    tv.addEventListener("pointerenter", () => { startNoise(); }, { passive:true });
    tv.addEventListener("pointerleave", () => { stopNoise(); }, { passive:true });

    // MÃ³vil: mantener pulsado
    tv.addEventListener("touchstart", () => { startNoise(); }, { passive:true });
    tv.addEventListener("touchend", () => { stopNoise(); }, { passive:true });

    // Intensidad por posiciÃ³n (centro = mÃ¡s â€œsintonizaciÃ³nâ€)
    tv.addEventListener("pointermove", (e) => {
      if (!running || !unlocked) return;
      const r = tv.getBoundingClientRect();
      const x = (e.clientX - r.left) / r.width;
      const y = (e.clientY - r.top) / r.height;
      const dx = x - 0.5, dy = y - 0.5;
      const dist = Math.min(1, Math.sqrt(dx*dx + dy*dy) / 0.82);
      const intensity = 1 - dist;
      setIntensity(intensity);
    }, { passive:true });

    // BotÃ³n overlay para activar sonido (solo si el navegador lo requiere)
    gateBtn.addEventListener("click", async () => {
      const ok = await unlock();
      if(ok){
        hideGate();
        // si justo estaban intentando hover, arrancamos
        startNoise();
      }
    });

    // Si la pestaÃ±a se oculta: apagar
    document.addEventListener("visibilitychange", () => {
      if (document.hidden) stopNoise();
    });

  })();
  </script>
</body>
</html>


